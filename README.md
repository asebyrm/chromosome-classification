
# ğŸ§¬ Chromosome Classification with Deep Learning

This project aims to classify human chromosomes from microscopy images using convolutional neural networks (CNNs), specifically ResNet-based architectures. It includes preprocessing, annotation, model training, prediction, and evaluation pipelines.

---

## ğŸ“ Project Structure
```
.
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                   # Original chromosome images and annotation .txt files
â”‚   â””â”€â”€ processed/
â”‚       â”œâ”€â”€ chromosomes/       # Extracted and labeled chromosome crops
â”‚       â”œâ”€â”€ train/             # Training dataset (class-based folders)
â”‚       â””â”€â”€ test/              # Test dataset (class-based folders)
â”œâ”€â”€ models/                    # Trained model checkpoints (.pth)
â”œâ”€â”€ outputs/
â”‚   â”œâ”€â”€ annotated_images/      # Images with predicted chromosome labels
â”‚   â”œâ”€â”€ predicted_labels/      # Predicted labels (.txt) by model
â”‚   â””â”€â”€ true_labels/           # Ground-truth labels (.txt) for evaluation
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ annotation.py          # Draws polygon annotations and IDs on chromosome images
â”‚   â”œâ”€â”€ chromosome_cut.py      # Extracts rotated and cropped individual chromosomes from annotated images
â”‚   â”œâ”€â”€ classifier.py          # Model training
â”‚   â”œâ”€â”€ confusion.py           # Confusion matrix analysis
â”‚   â”œâ”€â”€ filecount.py           # Duplicate file name checker
â”‚   â”œâ”€â”€ predict_and_annotate.py# Runs prediction and saves annotated images
â”‚   â”œâ”€â”€ split_dataset.py       # Train/test split of cropped chromosomes
â”‚   â””â”€â”€ testpredicter.py       # Auxiliary script for testing prediction routines 
```
---

## ğŸ§  Model

- Uses pretrained ResNet18 and ResNet34 from torchvision.models
- Final layer replaced with a 24-class classifier (chromosomes 1â€“22, X, Y)

---

## ğŸš€ How to Run

1. Clone the repository
```
    git clone https://github.com/asebyrm/chromosome-classification.git
    cd chromosome-classification
```
2. Install dependencies
```
    pip install -r requirements.txt
```
3. Preprocess and split the dataset
```
    python src/chromosome_cut.py
    python src/split_dataset.py
```
4. Train the model
```
    python src/classifier.py
```
5. Evaluate model performance
```
    python src/confusion.py
```
6. Run prediction and annotate results
```
    python src/predict_and_annotate.py
```
---

## ğŸ“Š Sample Output

- Annotated predictions â†’ outputs/annotations/
- Text predictions â†’ outputs/predicted_labels/
- Ground truth        â†’ outputs/true_labels/
- Evaluation plot     â†’ Confusion matrix displayed during evaluation

---

## ğŸ–¼ï¸ Example Annotated Image

Below is a sample annotated output generated by the model:

![Sample Prediction](assets/C6-0151_37_annotated.jpg)
---

## ğŸ“¦ Dependencies

Install with:
```
    pip install -r requirements.txt
```
Main libraries:
```
- torch
- torchvision
- opencv-python
- pillow
- matplotlib
- seaborn
- scikit-learn
- tqdm
```
---

## ğŸ‘¤ Author

Ahmet Selim Bayram  
Artificial Intelligence Engineering  
Istanbul Technical University

---

## âš ï¸ Dataset Notice

The dataset used in this project was provided by my professor for research purposes.  
**Due to data ownership and privacy concerns, raw image data and processed outputs are not included in this repository.**  

Only model training code, annotation scripts, and evaluation logic are shared as open source.  
Please contact the project author if you are interested in collaborating on data-driven research.

